{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>::: 차 수리 견적 계산 :::</title>
    <!-- css파일 불러오기 -->
    {% include 'mainapp/include/css.html' %}
    <link rel="stylesheet" type="text/css" href="/static/css/result.css">
    <style>
    .file-input {
        width: 25%;
    }
</style>
</head>
<body>
    <div class="header">
        {% include 'mainapp/include/navbar.html' %}
        <div class="element">
        <h3 style="text-align: center;">차 수리 견적 계산</h3>
            <hr/>


        <div class="container">
            <div class="image-upload" id="image-upload">
                <form id="imageForm" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="file" name="image" accept="image/*" required onchange="previewImage(event)">
                    <br>
                    <div id="imagePreview"></div>
                    <br>
                    <button type="button" onclick="uploadImage()">Submit</button>
                    <button type="button" onclick="window.location.href = '/'">Exit</button>

                </form>
            </div>


            <div id="car_data">
            </div>



            
            <div class="image-show" id="image-show"></div>
        </div>

         <!-- <div class="container"> 파일드로그앤드롭 html
    <div class="drag-area">
        <div class="icon">
            <i class="fa-solid fa-cloud-arrow-up"></i>
        </div>
        <h2>Drag & Drop to Upload File</h2>
        <span>OR</span>
        <button>Browse File</button>
        <input type="file" hidden>
    </div>
</div> -->
    </div>
    <!-- js파일불러오기 -->
    {% include 'mainapp/include/js.html' %}

<script>
 <!-- 파일 드로그 앤 드롭 관련 js -->
const dropArea = document.querySelector(".drag-area");
dragText = dropArea.querySelector("h2");
button = dropArea.querySelector("button");
input = dropArea.querySelector("input");
let file;

button.onclick = () =>{
    input.click();
}
input.addEventListener("change", function(){
    file = this.files[0];
    showFile();
    dropArea.classList.add("active");
})

// 파일을 영역안으로 드래그 했을때, 선이 점선에서 실선으로 바뀌게
dropArea.addEventListener("dragover",()=>{
    event.preventDefault();
    // console.log("File is over DragArea");
    dropArea.classList.add("active");
    dragText.textContent = "Release to Upload File";
});

// 파일을 영역밖으로 드래그 했을때
dropArea.addEventListener("dragleave",()=>{
    // console.log("File is outside DragArea");
    dropArea.classList.remove("active");
    dragText.textContent = "Drag & Drop to Upload File";
});

    // 파일을 영역으로 놓았을때
    dropArea.addEventListener("drop",()=>{
    event.preventDefault();
    // console.log("File on Droparea");
    file = event.dataTransfer.files[0];
    showFile();
    
});
function showFile(){
    let fileType = file.type;
    console.log(file);
    let validExtensions = ["image/jpeg","image/jpg","image/png"];
    if(validExtensions.includes(fileType)){
        let fileReader = new FileReader();
        fileReader.onload = ()=>{
            let fileURL = fileReader.result;
            
            let imgTag = '<img src=" ${fileURL} " alt="">';
            dropArea.innerHTML = imgTag;
        }
        fileReader.readAsDataURL(file);
    }else{
        alert("이미지 파일이 아닙니다.");
        dropArea.classList.remove("active");
        dragText.textContent = "Drag & Drop to Upload File";
    }
}

      </script>
    </script>
</body>
</html>
